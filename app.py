from flask import Flask, request, jsonify
import requests, os

app = Flask(__name__)

GROUP_ID = 7300579  # Replace with your group ID
RANK_ID = 45979915  # Replace with the rank ID you want to assign
COOKIE = "_|WARNING:-DO-NOT-SHARE-THIS.--Sharing-this-will-allow-someone-to-log-in-as-you-and-to-steal-your-ROBUX-and-items.|_322DB11EC3B188ABFE6C00D643D2808BA33577DF5B8CA5C64E0AA237F1C656ECC38166BC50A672021135A1F3C1942D4048D7E9CCACF9D39809B9739DE125B7E3762B3C7629E49886A2831D05F3BDE3FA01F3370E14680759BB85C14B35DEA22276642159DA71379DFBCCC8617818EB2501BE2481907D9302D5B427C7A881F00C5C92DBC17CF656B042A8199FB6291871D00F13010C4592332D48CAAB5E8718496B6316D3FCED63DC7B3D2AE2541EC7D7E7B0451F2DB0E7057C428EF1297BD0409C960CE336CD5C9089E45783E5BFE059F7FF6C0095B19313DE3157834CD8D5FF33FCFC2D9C8798A1530DD2DC316F761250F25EF07FC5E264E38906EA9F412B36E907E4F75BFC9488EF30C5FB1738FACBBE95CDD4E9B5D26C8DD97724A5A2122A0844C4C1B32D16F73629809CA80AF57B89EC12C07642C6F9E6CCEABA714FF2F446F5BB54DAA60A756E58F38C2A2634032A3839F23185EC48AE8BC277D4B1A7B5186BC616E113DC53C9702D84967F1FA375B58485EBBB75F35914EF9E8F5826187EAD168806138B064879FB32BAAD74A830D1E7E84A2D5956529F2FD66A3D4D91D41BE0E1F519561EEDA93F597F0653C35FA30D98E16CF692DE2A7EC5C861BAA62553B21F677F7B700937098DCA2CC7F87E13C957CC652BD4CCAC9A33866805FB9FAEB6FC9418A80DD5543362E0B83F7587C1D4FDFAB8826BB0A58BC2EC15739DF61E63F5B0B440C0052F982B814CABD21FC342884606C246F8FF1364F82C5B8EC6D61C06132EEA86E62618D8A45473EBC78A7682F45AAB30921DA52220499757AF7EAA52099A6CA44725F5D24B03C4FFDCD213BC743A9B7CC06A41A2E4B453025D4ACF1163A9E7CCB23A2CC15DA04AD66A1A28B1EF62540C8E9DA0237B626A04AE5E53046EB91C80BD4D934F88AFF459D26AED130192AE6515EEF018E5F0E383205121057B6E7BC9490ABE37C2759391BEF3ACE35C27F575E02A0D38ABCD18210072675F145726D460C0BF63B8DA0A40A66D0735C7196DAD04E7F7470BEB3F7217B92389"  # Replace with your .ROBLOSECURITY cookie

print(GROUP_ID)

session = requests.Session()
session.cookies['.ROBLOSECURITY'] = COOKIE

def get_xcsrf_token():
    response = session.post("https://auth.roblox.com/v2/logout").headers["X-CSRF-TOKEN"]
    return response

@app.route('/rank-user', methods=['POST'])
def rank_user():
    data = request.get_json()
    user_id = data.get('userId')

    if not user_id:
        return jsonify({'message': 'User ID is required'}), 400

    try:
        xcsrf_token = get_xcsrf_token()
        url = f'https://groups.roblox.com/v1/groups/{GROUP_ID}/users/{user_id}'
        headers = {
            'X-CSRF-TOKEN': xcsrf_token,
            'Content-Type': 'application/json'
        }

        data={
            'roleId': RANK_ID
        }

        response = session.patch(url, json=data, headers=headers)

        if response.status_code == 200:
            return jsonify({'message': 'User ranked successfully!'}), 200
        else:
            return jsonify({'message': 'Failed to rank user.', 'details': response.text}), response.status_code

    except Exception as e:
        print(e)
        return jsonify({'message': 'Server error.'}), 500

if __name__ == '__main__':
    app.run(debug=True)